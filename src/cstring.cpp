#include "cstring.hpp"

CString::CString(const QString& string)
{
    cString = new uint8_t[string.length() * MAX_SIZE_OF_UTF8_ENCODED_CHARACTER + 1]();
    cStringSize = fromString(string, cString);
}

CString::~CString()
{
    delete[] cString;
}

uint8_t* CString::data()
{
    return cString;
}

uint16_t CString::size()
{
    return cStringSize;
}

QString CString::toString(const uint8_t* cString, uint16_t cStringSize)
{
    return QString::fromUtf8(reinterpret_cast<const char*>(cString), cStringSize - 1);
}

QString CString::toString(const uint8_t* cString)
{
    return QString::fromUtf8(reinterpret_cast<const char*>(cString), -1);
}

uint16_t CString::fromString(const QString& string, uint8_t* cString)
{
    QByteArray byteArray = QByteArray(string.toUtf8());
    memcpy(cString, reinterpret_cast<uint8_t*>(byteArray.data()), byteArray.size());
    return byteArray.size() + 1;
}

